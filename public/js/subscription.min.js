!function(){"use strict";var e=document.getElementById("stripe-key"),n=e?e.value:null;if(n){Stripe(n);document.addEventListener("DOMContentLoaded",function(){var e=document.getElementById("btn-monthly"),n=document.getElementById("btn-annual"),o=document.getElementById("btn-cancel");e&&e.addEventListener("click",function(){t("monthly",this)}),n&&n.addEventListener("click",function(){t("annual",this)}),o&&o.addEventListener("click",function(){!function(){if(!confirm("Are you sure you want to cancel your subscription? You will retain access until the end of your billing period."))return;var e=document.getElementById("loading");e&&(e.style.display="block");var n=document.getElementById("csrf-token"),t=n?n.value:"";fetch("/dashboard/subscription/cancel-subscription",{method:"POST",headers:{"Content-Type":"application/json","x-csrf-token":t},body:JSON.stringify({immediately:!1})}).then(function(e){return e.json()}).then(function(e){e.success?(alert(e.message),window.location.reload()):alert("Error: "+e.error)}).catch(function(e){console.error("Error:",e),alert("An error occurred. Please try again.")}).finally(function(){e&&(e.style.display="none")})}()})})}else console.warn("Stripe key not found");function t(e,n){n.disabled=!0,n.innerHTML="Processing...";var t=document.getElementById("loading");t&&(t.style.display="block");var r=document.getElementById("csrf-token"),i=r?r.value:"";fetch("/dashboard/subscription/checkout",{method:"POST",headers:{"Content-Type":"application/json","x-csrf-token":i},body:JSON.stringify({plan:e})}).then(function(e){return e.json()}).then(function(r){r.success?window.location.href=r.url:(alert("Error: "+r.error),o(n,e),t&&(t.style.display="none"))}).catch(function(r){console.error("Error:",r),alert("An error occurred. Please try again."),o(n,e),t&&(t.style.display="none")})}function o(e,n){e.disabled=!1;e.innerHTML=("monthly"===n?"Subscribe Monthly ":"Subscribe Annually ")+'<svg fill="none" stroke="currentColor" viewBox="0 0 24 24" style="width:20px;height:20px;"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"/></svg>'}}();