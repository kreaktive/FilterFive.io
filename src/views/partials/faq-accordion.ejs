<!-- FAQ Accordion Component -->
<!--
  Usage: <%- include('partials/faq-accordion', {
    faqs: [
      { question: "Your question?", answer: "Your answer" },
      { question: "Another question?", answer: "<p>HTML is supported</p>" }
    ],
    sectionTitle: "Optional Section Title",
    sectionIcon: "optional-svg-path"
  }) %>
-->

<% if (typeof sectionTitle !== 'undefined') { %>
<div class="flex items-center gap-3 mb-6 border-b border-gray-100 pb-4">
  <% if (typeof sectionIcon !== 'undefined') { %>
  <div class="p-2 rounded-lg bg-gray-50 text-[#FFBA49]">
    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><%- sectionIcon %></svg>
  </div>
  <% } %>
  <h2 class="text-2xl md:text-3xl font-bold font-title text-[#500B42]"><%= sectionTitle %></h2>
</div>
<% } %>

<div class="space-y-0 faq-accordion-container">
  <% faqs.forEach(function(faq) { %>
  <div class="faq-item border-b border-gray-200 last:border-0">
    <button class="faq-toggle w-full flex justify-between items-center py-6 text-left focus:outline-none group">
      <span class="text-lg font-bold group-hover:text-[#A1438E] transition-colors text-[#500B42]"><%= faq.question %></span>
      <div class="flex-shrink-0 ml-4">
        <svg class="faq-icon w-5 h-5 text-gray-500 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/></svg>
      </div>
    </button>
    <div class="faq-content overflow-hidden max-h-0 transition-all duration-300 ease-out">
      <div class="text-gray-600 leading-relaxed pb-6"><%- faq.answer %></div>
    </div>
  </div>
  <% }); %>
</div>

<style>
  .faq-content { max-height: 0; overflow: hidden; transition: max-height 0.3s ease-out; }
  .faq-content.open { max-height: 2000px; }
  .faq-icon { transition: transform 0.3s ease; }
  .faq-icon.rotate-45 { transform: rotate(45deg); }
</style>

<script<%- typeof cspNonce !== 'undefined' ? ` nonce="${cspNonce}"` : '' %>>
(function() {
  document.querySelectorAll('.faq-toggle').forEach(function(toggle) {
    toggle.addEventListener('click', function() {
      const content = this.nextElementSibling;
      const icon = this.querySelector('.faq-icon');

      // Close other open items in same container
      const container = this.closest('.faq-accordion-container');
      if (container) {
        container.querySelectorAll('.faq-content.open').forEach(function(openContent) {
          if (openContent !== content) {
            openContent.classList.remove('open');
            openContent.previousElementSibling.querySelector('.faq-icon').classList.remove('rotate-45');
          }
        });
      }

      content.classList.toggle('open');
      icon.classList.toggle('rotate-45');
    });
  });
})();
</script>
